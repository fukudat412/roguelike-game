# ローグライク探索ゲーム - Phase 2 Complete

Elonaのような無限に遊べるローグライク探索ゲーム。Phase 2まで実装完了しました。

## 実装された機能

### Phase 1: MVP完了 ✅

✅ **プロジェクトセットアップ**
- TypeScript + Vite環境
- Canvas描画基盤
- レスポンシブなUI

✅ **ゲームループと基盤**
- 固定タイムステップのゲームループ
- イベント駆動システム（EventBus）
- ゲーム状態管理（プレイヤーターン/敵ターン）
- キーボード入力システム（WASD/矢印キー/テンキー）

✅ **マップシステム**
- ランダムルーム生成アルゴリズム
- タイルベースのマップ（床、壁）
- FOV（視界）システム
- マップ探索記憶機能

✅ **プレイヤーシステム**
- 移動とアニメーション
- ステータス管理（HP、攻撃力、防御力）
- 経験値とレベルアップ
- カメラ追従

✅ **敵システム**
- 3種類の敵（ゴブリン、オーク、トロール）
- シンプルなAI（プレイヤーに近づく）
- ランダム配置

✅ **戦闘システム**
- ターン制戦闘
- ダメージ計算（攻撃力 - 防御力/2 ± ランダム変動）
- クリティカルヒット（10%確率で2倍）
- 隣接攻撃

✅ **UI システム**
- リアルタイムステータス表示
- メッセージログ（戦闘ログ、イベント）
- ゲームオーバー画面
- リスタート機能

### Phase 2: コアゲームプレイ完了 ✅

✅ **インベントリシステム**
- 20スロットのインベントリ
- アイテム拾う/捨てる機能
- スタック管理（消費アイテム）
- レア度システム（Common, Uncommon, Rare, Epic, Legendary）
- インベントリUI（I キーで開閉）

✅ **装備システム**
- 3つの装備スロット（武器、防具、アクセサリー）
- 装備によるステータスボーナス
- 装備の自動識別と装着
- 装備変更時の自動ステータス更新
- ベースステータスと装備ボーナスの分離管理

✅ **アイテムシステム**
- 回復ポーション（小/中/大）
- 武器（錆びた剣、鉄の剣、鋼の剣、魔法の剣）
- 防具（革の鎧、チェインメイル、プレートアーマー）
- 巻物（テレポート、火球）
- レア度ベースのランダム生成
- カラーコード表示

✅ **多階層ダンジョン**
- 無限階層システム
- 階段による階層移動
- 階層ごとのマップ生成
- 階層の状態保持
- 階層表示

✅ **敵のバリエーション（15種類）**
- 序盤（1-3階）: ゴブリン、コボルド、巨大ネズミ
- 中盤（4-7階）: オーク、スケルトン、狼、ゾンビ
- 後半（8-12階）: トロール、オーガ、レイス、ヴァンパイア
- 終盤（13階+）: デーモン、ドラゴン、リッチ、古代竜

✅ **難易度スケーリング**
- 階層に応じた敵の出現
- 敵の数が階層ごとに増加
- 敵のステータスが階層に応じて強化
- 経験値報酬のスケーリング

## 起動方法

```bash
# 依存関係をインストール（初回のみ）
npm install

# 開発サーバーを起動
npm run dev

# ブラウザで開く
# http://localhost:3000/
```

## 操作方法

### 移動
- **WASD**: 上下左右移動
- **矢印キー**: 上下左右移動
- **テンキー (2468)**: 上下左右移動

### アクション
- **敵に向かって移動**: 攻撃
- **スペースキー**: 待機
- **G**: アイテムを拾う
- **I**: インベントリを開く/閉じる
- **U**: アイテムを使う（インベントリ内）
- **Q**: アイテムを捨てる（インベントリ内）
- **>**: 階段を降りる

### インベントリ操作
1. **I** キーでインベントリを開く
2. アイテムをクリックして選択
3. **使う** ボタンで装備/消費
4. **捨てる** ボタンで地面に配置
5. **I** または **ESC** で閉じる

## ゲームの目標

Phase 2では以下が可能です：
1. ダンジョンを探索し、アイテムを収集する
2. 装備を強化してステータスを上げる
3. 回復ポーションを使って生存する
4. 階段を降りてより深い階層を探索する
5. 強力な敵を倒して経験値を獲得する
6. できるだけ深い階層まで到達する

## プロジェクト構造

```
game_1/
├── index.html              # エントリーポイント
├── package.json            # npm設定
├── tsconfig.json          # TypeScript設定
├── vite.config.ts         # Vite設定
└── src/
    ├── main.ts            # アプリケーション初期化
    ├── core/              # ゲームループ、状態管理、入力
    │   ├── Game.ts
    │   ├── GameState.ts
    │   ├── Input.ts
    │   └── EventBus.ts
    ├── renderer/          # Canvas描画
    │   └── Renderer.ts
    ├── world/             # マップ、タイル、生成
    │   ├── Map.ts
    │   ├── Tile.ts
    │   ├── Cell.ts
    │   └── generators/
    │       └── RoomGenerator.ts
    ├── entities/          # プレイヤー、敵、コンポーネント
    │   ├── Entity.ts
    │   ├── Player.ts
    │   ├── Enemy.ts
    │   └── components/
    │       ├── Position.ts
    │       └── Stats.ts
    ├── combat/            # 戦闘システム
    │   └── CombatSystem.ts
    ├── ui/                # UIマネージャー、メッセージログ
    │   ├── UIManager.ts
    │   └── MessageLog.ts
    └── utils/             # ユーティリティ
        └── Vector2D.ts
```

## 実装されたシステム詳細

### イベント駆動アーキテクチャ
- EventBusによる疎結合な設計
- 戦闘、移動、UI更新などすべてイベント経由

### レンダリングシステム
- Canvas 2Dコンテキスト使用
- タイルベース描画（32x32ピクセル）
- カメラシステム（プレイヤー追従）
- レイヤー管理（マップ → エンティティ → UI）

### マップ生成
- ランダムルーム配置アルゴリズム
- L字型通路で部屋を接続
- 衝突検出

### AI システム
- シンプルな追跡AI
- 視界範囲チェック（10タイル）
- 隣接判定による攻撃

## 次のフェーズ予定（Phase 3）

Phase 3では以下の機能を実装予定：
- 経験値システムの改良（スキルポイント）
- FOV（視界）システムの改善
- 改良されたAI（パスファインディング）
- アイテムの接頭辞/接尾辞システム
- ステータス効果（毒、麻痺、混乱）
- より複雑なマップ生成（洞窟、BSP）
- 店システム

## 技術スタック

- **TypeScript**: 型安全な開発
- **Vite**: 高速なビルドツール
- **Canvas API**: 2D描画
- **イベント駆動**: 疎結合な設計

## デバッグ

開発者コンソールで以下が利用可能：
```javascript
// グローバルゲームインスタンス
window.game

// プレイヤー情報
window.game.player

// マップ情報
window.game.map

// 敵リスト
window.game.enemies
```

## トラブルシューティング

### ゲームが起動しない
1. `npm install` を実行してください
2. ブラウザのコンソールでエラーを確認してください
3. Canvasをサポートするモダンブラウザを使用してください

### パフォーマンスが悪い
- Canvasサイズを調整してください（index.html）
- FOV範囲を狭めてください（Game.ts）

## ライセンス

このプロジェクトは教育目的で作成されています。
